import{ModuleNames as xt}from"@ag-grid-community/core";import{EnterpriseCoreModule as St}from"@ag-grid-enterprise/core";import{Component as kt,RefPlaceholder as vt}from"@ag-grid-community/core";import{_warnOnce as J}from"@ag-grid-community/core";import{_Util as Q}from"ag-charts-community";import{_Scale as Dt,_Scene as O,_Util as bt}from"ag-charts-community";import{_warnOnce as Lt}from"@ag-grid-community/core";function E(e,t="solid"){const i={solid:[],dash:[4,3],dot:[1,3],dashDot:[4,3,1,3],dashDotDot:[4,3,1,3,1,3],shortDot:[1,1],shortDash:[3,1],shortDashDot:[3,1,1,1],shortDashDotDot:[3,1,1,1,1,1],longDash:[8,3],longDashDot:[8,3,1,3],longDashDotDot:[8,3,1,3,1,3]},s={solid:[],dash:[3,3],dot:[0,3],dashDot:[3,3,0,3],dashDotDot:[3,3,0,3,0,3],shortDot:[0,2],shortDash:[2,2],shortDashDot:[2,2,0,2],shortDashDotDot:[2,2,0,2,0,2],longDash:[7,3],longDashDot:[7,3,0,3],longDashDotDot:[7,3,0,3,0,3]};return e==="round"||e==="square"?s[t]==null?(tt(t),s.solid):s[t]:i[t]==null?(tt(t),i.solid):i[t]}function tt(e){Lt(`'${e}' is not a valid 'lineDash' option.`)}import{_Scene as Y}from"ag-charts-community";function et(e){switch(e){case"circle":return Y.Circle;case"square":return Y.Square;case"diamond":return Y.Diamond;default:return Y.Circle}}import{_errorOnce as wt}from"@ag-grid-community/core";import{_Scale as Wt,_Scene as it,_Util as Ct}from"ag-charts-community";var zt=`
.ag-sparkline-tooltip-wrapper {
    position: absolute;
    user-select: none;
    pointer-events: none;
}

.ag-sparkline-tooltip {
    position: relative;
    font: 12px arial,sans-serif;
    border-radius: 2px;
    box-shadow: 0 1px 3px rgb(0 0 0 / 20%), 0 1px 1px rgb(0 0 0 / 14%);
    line-height: 1.7em;
    overflow: hidden;
    white-space: nowrap;
    z-index: 99999;
    background-color: rgb(255, 255, 255);
    color: rgba(0,0,0, 0.67);
}

.ag-sparkline-tooltip-content {
    padding: 0 7px;
    opacity: 1;
}

.ag-sparkline-tooltip-title {
    padding-left: 7px;
    opacity: 1;
}

.ag-sparkline-tooltip-wrapper-hidden {
    top: -10000px !important;
}

.ag-sparkline-wrapper {
    box-sizing: border-box;
    overflow: hidden;
}
`,{extent:_t,isNumber:P,isString:Nt,isStringObject:Mt,isDate:st,createId:Tt,Padding:At}=Ct,{LinearScale:q,BandScale:Ot,TimeScale:nt}=Wt,Ft=class{constructor(){this.type="category",this.stroke="rgb(204, 214, 235)",this.strokeWidth=1}},at=class Z{constructor(){this.id=Tt(this),this.seriesRect={x:0,y:0,width:0,height:0},this._context=void 0,this._container=void 0,this._data=void 0,this.padding=new At(3),this.xKey="x",this.yKey="y",this.dataType=void 0,this.xData=[],this.yData=[],this.min=void 0,this.max=void 0,this.yScale=new q,this.axis=new Ft,this.highlightStyle={size:6,fill:"yellow",stroke:"silver",strokeWidth:1},this._width=100,this._height=100,this.smallestInterval=void 0,this.layoutId=0,this.defaultDateFormatter=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),this._onMouseMove=this.onMouseMove.bind(this),this._onMouseOut=this.onMouseOut.bind(this);const t=new it.Group;this.rootGroup=t;const i=document.createElement("div");i.setAttribute("class","ag-sparkline-wrapper");const s=new it.Scene({});this.scene=s,this.canvasElement=s.canvas.element,s.setRoot(t),s.setContainer(i),this.resizeAndSetDimensions(this.width,this.height),Z.tooltipDocuments.includes(document)||this.initialiseTooltipStyles(),this.setupDomEventListeners(this.canvasElement)}set context(t){this._context!==t&&(this._context=t)}get context(){return this._context}set container(t){if(this._container!==t){const{parentNode:i}=this.canvasElement;i?.removeChild(this.canvasElement),t&&t.appendChild(this.canvasElement),this._container=t}}get container(){return this._container}set data(t){this._data!==t&&(this._data=t,this.processData(),this.mouseMoveEvent&&this.highlightedDatum&&this.updateHitPoint(this.mouseMoveEvent))}get data(){return this._data}resizeAndSetDimensions(t,i){this.scene.resize(t,i),this.seriesRect.width=t,this.seriesRect.height=i}initialiseTooltipStyles(){const t=document.createElement("style");t.innerHTML=zt,document.head.insertBefore(t,document.head.querySelector("style")),Z.tooltipDocuments.push(document)}set width(t){this._width!==t&&(this._width=t,this.scene.resize(t,this.height),this.scheduleLayout())}get width(){return this._width}set height(t){this._height!==t&&(this._height=t,this.scene.resize(this.width,t),this.scheduleLayout())}get height(){return this._height}update(){}updateYScale(){this.updateYScaleRange(),this.updateYScaleDomain()}updateYScaleDomain(){}updateYScaleRange(){const{yScale:t,seriesRect:i}=this;t.range=[i.height,0]}updateXScale(){const{type:t}=this.axis;this.xScale=this.getXScale(t),this.updateXScaleRange(),this.updateXScaleDomain()}updateXScaleRange(){this.xScale.range=[0,this.seriesRect.width]}updateXScaleDomain(){const{xData:t,xScale:i}=this;let s;(i instanceof q||i instanceof nt)&&(s=_t(t)),this.xScale.domain=s?s.slice():t}getXScale(t="category"){switch(t){case"number":return new q;case"time":return new nt;case"category":default:return new Ot}}updateAxisLine(){}updateAxes(){this.updateYScale(),this.updateXScale(),this.updateAxisLine()}updateCrosshairs(){this.updateXCrosshairLine(),this.updateYCrosshairLine()}generateNodeData(){return[]}getNodeData(){return[]}updateNodes(){}updateXCrosshairLine(){}updateYCrosshairLine(){}highlightDatum(t){this.updateNodes()}dehighlightDatum(){this.highlightedDatum=void 0,this.updateNodes(),this.updateCrosshairs()}onMouseMove(t){this.mouseMoveEvent=t,this.updateHitPoint(t)}renderScene(){this.scene.render().catch(t=>wt("chart rendering failed",t))}updateHitPoint(t){const i=this.pickClosestSeriesNodeDatum(t.offsetX,t.offsetY);if(!i)return;const s=this.highlightedDatum;this.highlightedDatum=i,(this.highlightedDatum&&!s||this.highlightedDatum&&s&&this.highlightedDatum!==s)&&(this.highlightDatum(i),this.updateCrosshairs(),this.renderScene()),(this.processedOptions?.tooltip?.enabled??!0)&&this.handleTooltip(t,i)}onMouseOut(t){this.dehighlightDatum(),this.tooltip.toggle(!1),this.renderScene()}processData(){const{data:t,yData:i,xData:s}=this;if(!t||this.invalidData(this.data))return;i.length=0,s.length=0;const n=t.length,r=this.getDataType(t);this.dataType=r;const{type:o}=this.axis,l=o!=="number"&&o!=="time"?"category":o,a=l==="number"||l==="time",h=(c,g)=>{this.smallestInterval==null&&(this.smallestInterval={x:1/0,y:1/0});const{x}=this.smallestInterval,u=Math.abs(c-g);u>0&&u<x&&(this.smallestInterval.x=u)};let y;if(r==="number")for(let c=0;c<n;c++){const g=c,x=t[c],u=this.getDatum(g,l),f=this.getDatum(x,"number");a&&h(u,y),s.push(u),i.push(f),y=u}else if(r==="array")for(let c=0;c<n;c++){const g=t[c];if(Array.isArray(g)){const x=g[0],u=g[1],f=this.getDatum(x,l),m=this.getDatum(u,"number");if(f==null)continue;a&&h(f,y),s.push(f),i.push(m),y=f}}else if(r==="object"){const{yKey:c,xKey:g}=this;for(let x=0;x<n;x++){const u=t[x];if(typeof u=="object"&&!Array.isArray(u)){const f=u[g],m=u[c],p=this.getDatum(f,l),S=this.getDatum(m,"number");if(p==null)continue;a&&h(p,y),s.push(p),i.push(S),y=p}}}this.updateAxes(),this.immediateLayout()}getDataType(t){for(const i of t)if(i!=null){if(P(i))return"number";if(Array.isArray(i))return"array";if(typeof i=="object")return"object"}}getDatum(t,i){if(i==="number"&&P(t)||i==="time"&&(P(t)||st(t)))return t;if(i==="category"){if(Nt(t)||st(t)||P(t))return{toString:()=>String(t)};if(Mt(t))return t}}get layoutScheduled(){return!!this.layoutId}scheduleLayout(){this.layoutId&&cancelAnimationFrame(this.layoutId),this.layoutId=requestAnimationFrame(()=>{this.immediateLayout(),this.layoutId=0})}immediateLayout(){this.setSparklineDimensions(),!this.invalidData(this.data)&&(this.updateXScaleRange(),this.updateYScaleRange(),this.updateAxisLine(),this.update(),this.renderScene())}setSparklineDimensions(){const{width:t,height:i,padding:s,seriesRect:n,rootGroup:r}=this,o=t-s.left-s.right,l=i-s.top-s.bottom;n.width=o,n.height=l,n.x=s.left,n.y=s.top,r.translationX=n.x,r.translationY=n.y}pickClosestSeriesNodeDatum(t,i){let s=1/0,n;const r=this.rootGroup.transformPoint(t,i),o=this.getNodeData();for(let l=0;l<o.length;l++){const a=o[l];if(!a.point)return;const h=this.getDistance(r,a.point);h<=s&&(s=h,n=a)}return n}getDistance(t,i){return Math.abs(t.x-i.x)}handleTooltip(t,i){const{seriesDatum:s}=i,{canvasElement:n}=this,{clientX:r,clientY:o}=t,l=this.processedOptions?.tooltip,a={pageX:r,pageY:o,position:{xOffset:l?.xOffset,yOffset:l?.yOffset},container:l?.container};a.container==null&&(a.container=n);const h=s.y,y=s.x;let c=l?.enabled??!0;const g=l?.renderer;if(g){const u=g({context:this.context,datum:s,yValue:h,xValue:y});c=typeof u!="string"&&u.enabled!==void 0?u.enabled:c}const x=c&&s.y!==void 0&&this.getTooltipHtml(i);x&&this.tooltip.show(a,x)}formatNumericDatum(t){return String(Math.round(t*10)/10)}formatDatum(t){const i=this.axis.type||"category";return i==="number"&&typeof t=="number"?this.formatNumericDatum(t):i==="time"&&(t instanceof Date||P(t))?this.defaultDateFormatter.format(t):String(t)}setupDomEventListeners(t){t.addEventListener("mousemove",this._onMouseMove),t.addEventListener("mouseout",this._onMouseOut)}cleanupDomEventListeners(t){t.removeEventListener("mousemove",this._onMouseMove),t.removeEventListener("mouseout",this._onMouseOut)}invalidData(t){return!t||!Array.isArray(t)}destroy(){this.cleanupDomEventListeners(this.canvasElement),this.scene.destroy(),this.container=void 0}};at.tooltipDocuments=[];var K=at;function I(e,t){if(typeof e=="string")return e;t=t??{};const{content:i=t.content??"",title:s=t.title??void 0,color:n=t.color,backgroundColor:r=t.backgroundColor,opacity:o=t.opacity??1}=e;let l,a;n?(l=s?`<span class="${T}-title"; style="color: ${n}">${s}</span>`:"",a=`<span class="${T}-content" style="color: ${n}">${i}</span>`):(l=s?`<span class="${T}-title">${s}</span>`:"",a=`<span class="${T}-content">${i}</span>`);let h=`opacity: ${o}`;return r&&(h+=`; background-color: ${r.toLowerCase()}`),`<div class="${T}" style="${h}">
                ${l}
                ${a}
            </div>`}var T="ag-sparkline-tooltip",Rt=class{constructor(){this.element=document.createElement("div"),document.body.appendChild(this.element)}isVisible(){const{element:e}=this;if(e.classList)return!e.classList.contains(`${T}-wrapper-hidden`);const t=e.getAttribute("class");return t?t.split(" ").indexOf(`${T}-wrapper-hidden`)<0:!1}updateClass(e){const t=[`${T}-wrapper`];e!==!0&&t.push(`${T}-wrapper-hidden`),this.element.setAttribute("class",t.join(" "))}show(e,t){this.toggle(!1);const{element:i}=this;if(t!==void 0)i.innerHTML=t;else if(!i.innerHTML)return;const s=e.position?.xOffset??10,n=e.position?.yOffset??0;let r=e.pageX+s,o=e.pageY+n;const l=i.getBoundingClientRect();let a=window.innerWidth-l.width;if(e.container){const h=e.container.getBoundingClientRect();a=h.left+(h.width-l.width)}r>a&&(r=e.pageX-i.clientWidth-s),typeof scrollX<"u"&&(r+=scrollX),typeof scrollY<"u"&&(o+=scrollY),i.style.left=`${Math.round(r)}px`,i.style.top=`${Math.round(o)}px`,this.toggle(!0)}toggle(e){this.updateClass(e)}destroy(){const{parentNode:e}=this.element;e&&e.removeChild(this.element)}},{extent:It}=bt,{BandScale:Xt}=Dt,Bt=class{constructor(){this.enabled=!0,this.shape="circle",this.size=0,this.fill="rgb(124, 181, 236)",this.stroke="rgb(124, 181, 236)",this.strokeWidth=1,this.formatter=void 0}},Pt=class{constructor(){this.stroke="rgb(124, 181, 236)",this.strokeWidth=1}},Et=class{constructor(){this.xLine={enabled:!0,stroke:"rgba(0,0,0, 0.54)",strokeWidth:1,lineDash:"solid",lineCap:void 0},this.yLine={enabled:!1,stroke:"rgba(0,0,0, 0.54)",strokeWidth:1,lineDash:"solid",lineCap:void 0}}},Yt=class extends K{constructor(){super(),this.fill="rgba(124, 181, 236, 0.25)",this.strokePath=new O.Path,this.fillPath=new O.Path,this.xCrosshairLine=new O.Line,this.yCrosshairLine=new O.Line,this.areaSparklineGroup=new O.Group,this.xAxisLine=new O.Line,this.markers=new O.Group,this.markerSelection=O.Selection.select(this.markers,()=>this.markerFactory()),this.markerSelectionData=[],this.marker=new Bt,this.line=new Pt,this.crosshairs=new Et,this.rootGroup.append(this.areaSparklineGroup),this.xAxisLine.zIndex=500,this.fillPath.zIndex=50,this.strokePath.zIndex=1e3,this.xCrosshairLine.zIndex=2e3,this.yCrosshairLine.zIndex=2e3,this.markers.zIndex=2500,this.areaSparklineGroup.append([this.fillPath,this.xAxisLine,this.strokePath,this.xCrosshairLine,this.yCrosshairLine,this.markers])}markerFactory(){const{shape:e}=this.marker,t=et(e);return new t}getNodeData(){return this.markerSelectionData}update(){const e=this.generateNodeData();if(!e)return;const{nodeData:t,fillData:i,strokeData:s}=e;this.markerSelectionData=t,this.updateSelection(t),this.updateNodes(),this.updateStroke(s),this.updateFill(i)}updateYScaleDomain(){const{yData:e,yScale:t}=this,i=It(e);let s=0,n=1;i!==void 0&&(s=this.min=i[0],n=this.max=i[1]),s=s<0?s:0,n=n<0?0:n,t.domain=[s,n]}generateNodeData(){const{data:e,yData:t,xData:i,xScale:s,yScale:n}=this;if(!e)return;const r=!(s instanceof Xt),o=r?0:s.bandwidth/2,l=t.length,a=[],h=[],y=[];let c,g,x,u;const f=n.convert(0);for(let m=0;m<l;m++){const p=t[m],S=i[m],v=s.convert(r?s.toDomain(S):S)+o,L=p===void 0?NaN:n.convert(p);m+1<l&&(u=s.convert(r?s.toDomain(i[m+1]):i[m+1])+o),y.push({seriesDatum:{x:S,y:p},point:{x:v,y:L}}),p===void 0&&x!==void 0?(h.push({seriesDatum:void 0,point:{x,y:f}}),u!==void 0&&h.push({seriesDatum:void 0,point:{x:u,y:f}})):p!==void 0&&(h.push({seriesDatum:{x:S,y:p},point:{x:v,y:L}}),a.push({seriesDatum:{x:S,y:p},point:{x:v,y:L}}),c=c!==void 0?c:v,g=v),x=v}return h.push({seriesDatum:void 0,point:{x:g,y:f}},{seriesDatum:void 0,point:{x:c,y:f}}),{nodeData:a,fillData:h,strokeData:y}}updateAxisLine(){const{xScale:e,yScale:t,axis:i,xAxisLine:s}=this;s.x1=e.range[0],s.x2=e.range[1],s.y1=s.y2=0,s.stroke=i.stroke,s.strokeWidth=i.strokeWidth;const n=t.convert(0);s.translationY=n}updateSelection(e){this.markerSelection.update(e)}updateNodes(){const{highlightedDatum:e,highlightStyle:t,marker:i}=this,{size:s,fill:n,stroke:r,strokeWidth:o}=t,l=i.formatter;this.markerSelection.each((a,h,y)=>{const{point:c,seriesDatum:g}=h;if(!c)return;const x=h===e,u=x&&n!==void 0?n:i.fill,f=x&&r!==void 0?r:i.stroke,m=x&&o!==void 0?o:i.strokeWidth,p=x&&s!==void 0?s:i.size;let S;if(l){const v=y===0,L=y===this.markerSelectionData.length-1,k=g.y===this.min,w=g.y===this.max;S=l({datum:h,xValue:g.x,yValue:g.y,min:k,max:w,first:v,last:L,fill:u,stroke:f,strokeWidth:m,size:p,highlighted:x})}a.size=S&&S.size!=null?S.size:p,a.fill=S&&S.fill!=null?S.fill:u,a.stroke=S&&S.stroke!=null?S.stroke:f,a.strokeWidth=S&&S.strokeWidth!=null?S.strokeWidth:m,a.translationX=c.x,a.translationY=c.y,a.visible=S&&S.enabled!=null?S.enabled:i.enabled&&a.size>0})}updateStroke(e){const{strokePath:t,yData:i,line:s}=this,n=t.path;if(n.clear(),i.length<2)return;const r=e.length;let o=!0;for(let l=0;l<r;l++){const{point:a,seriesDatum:h}=e[l],y=a.x,c=a.y;h.y==null?o=!0:o?(n.moveTo(y,c),o=!1):n.lineTo(y,c)}t.lineJoin=t.lineCap="round",t.fill=void 0,t.stroke=s.stroke,t.strokeWidth=s.strokeWidth}updateFill(e){const{fillPath:t,yData:i,fill:s}=this,n=t.path,r=e.length;if(n.clear(),!(i.length<2)){for(let o=0;o<r;o++){const{point:l}=e[o],a=l.x,h=l.y;o>0?n.lineTo(a,h):n.moveTo(a,h)}n.closePath(),t.lineJoin="round",t.stroke=void 0,t.fill=s}}updateXCrosshairLine(){const{yScale:e,xCrosshairLine:t,highlightedDatum:i,crosshairs:{xLine:s}}=this;if(!s.enabled||i==null){t.strokeWidth=0;return}t.y1=e.range[0],t.y2=e.range[1],t.x1=t.x2=0,t.stroke=s.stroke,t.strokeWidth=s.strokeWidth??1,t.lineCap=s.lineCap==="round"||s.lineCap==="square"?s.lineCap:void 0;const{lineDash:n}=s;t.lineDash=Array.isArray(n)?n:E(t.lineCap,s.lineDash),t.translationX=i.point.x}updateYCrosshairLine(){const{xScale:e,yCrosshairLine:t,highlightedDatum:i,crosshairs:{yLine:s}}=this;if(!s.enabled||i==null){t.strokeWidth=0;return}t.x1=e.range[0],t.x2=e.range[1],t.y1=t.y2=0,t.stroke=s.stroke,t.strokeWidth=s.strokeWidth??1,t.lineCap=s.lineCap==="round"||s.lineCap==="square"?s.lineCap:void 0;const{lineDash:n}=s;t.lineDash=Array.isArray(n)?n:E(t.lineCap,s.lineDash),t.translationY=i.point.y}getTooltipHtml(e){const{dataType:t}=this,{seriesDatum:i}=e,s=i.y,n=i.x,r=this.formatNumericDatum(s),o=t==="array"||t==="object"?this.formatDatum(n):void 0,l={content:r,title:o},a=this.processedOptions?.tooltip?.renderer;return a?I(a({context:this.context,datum:i,yValue:s,xValue:n}),l):I(l)}};import{_Scale as Gt,_Scene as Vt,_Util as $t}from"ag-charts-community";import{_Scene as A,_Util as Ht}from"ag-charts-community";var Ut=class{constructor(){this.enabled=!0,this.fontSize=8,this.fontFamily="Verdana, sans-serif",this.fontStyle=void 0,this.fontWeight=void 0,this.color="rgba(70, 70, 70, 1)"}},{extent:jt}=Ht,qt=class extends Ut{constructor(){super(...arguments),this.formatter=void 0,this.placement="insideEnd"}},rt=class extends K{constructor(){super(),this.fill="rgb(124, 181, 236)",this.stroke="silver",this.strokeWidth=0,this.paddingInner=.1,this.paddingOuter=.2,this.valueAxisDomain=void 0,this.formatter=void 0,this.axisLine=new A.Line,this.bandWidth=0,this.sparklineGroup=new A.Group,this.rectGroup=new A.Group,this.labelGroup=new A.Group,this.rectSelection=A.Selection.select(this.rectGroup,A.Rect),this.labelSelection=A.Selection.select(this.labelGroup,A.Text),this.nodeSelectionData=[],this.label=new qt,this.rootGroup.append(this.sparklineGroup),this.rectGroup.zIndex=50,this.axisLine.zIndex=500,this.labelGroup.zIndex=1500,this.sparklineGroup.append([this.rectGroup,this.axisLine,this.labelGroup]),this.axisLine.lineCap="round",this.label.enabled=!1}getNodeData(){return this.nodeSelectionData}update(){this.updateSelections(),this.updateNodes()}updateSelections(){const e=this.generateNodeData();e&&(this.nodeSelectionData=e,this.updateRectSelection(e),this.updateLabelSelection(e))}updateNodes(){this.updateRectNodes(),this.updateLabelNodes()}calculateStep(e){const{xScale:t,paddingInner:i,paddingOuter:s,smallestInterval:n}=this,o=(t.domain[1]-t.domain[0])/(n?.x??1)+1,a=Math.min(o,50),h=a-1;return e/Math.max(1,2*s+h*i+a)}updateYScaleDomain(){const{yScale:e,yData:t,valueAxisDomain:i}=this,s=jt(t);let n=0,r=1;s!==void 0&&(n=this.min=s[0],r=this.max=s[1]),n=n<0?n:0,r=r<0?0:r,i&&(i[1]<r&&(i[1]=r),i[0]>n&&(i[0]=n)),e.domain=i||[n,r]}updateRectSelection(e){this.rectSelection.update(e)}updateRectNodes(){const{highlightedDatum:e,formatter:t,fill:i,stroke:s,strokeWidth:n}=this,{fill:r,stroke:o,strokeWidth:l}=this.highlightStyle;this.rectSelection.each((a,h,y)=>{const c=h===e,g=c&&r!==void 0?r:i,x=c&&o!==void 0?o:s,u=c&&l!==void 0?l:n;let f;const{x:m,y:p,width:S,height:v,seriesDatum:L}=h;if(t){const k=y===0,w=y===this.nodeSelectionData.length-1,F=L.y===this.min,z=L.y===this.max;f=t({datum:h,xValue:L.x,yValue:L.y,width:S,height:v,min:F,max:z,first:k,last:w,fill:g,stroke:x,strokeWidth:u,highlighted:c})}a.fill=f&&f.fill||g,a.stroke=f&&f.stroke||x,a.strokeWidth=f&&f.strokeWidth||u,a.x=a.y=0,a.width=S,a.height=v,a.visible=a.height>0,a.translationX=m,a.translationY=p})}updateLabelSelection(e){this.labelSelection.update(e,t=>{t.tag=1,t.pointerEvents=A.PointerEvents.None})}updateLabelNodes(){const{label:{enabled:e,fontStyle:t,fontWeight:i,fontSize:s,fontFamily:n,color:r}}=this;this.labelSelection.each((o,l)=>{const a=l.label;a&&e?(o.fontStyle=t,o.fontWeight=i,o.fontSize=s,o.fontFamily=n,o.textAlign=a.textAlign,o.textBaseline=a.textBaseline,o.text=a.text,o.x=a.x,o.y=a.y,o.fill=r,o.visible=!0):o.visible=!1})}getTooltipHtml(e){const{dataType:t}=this,{seriesDatum:i}=e,s=i.y,n=i.x,r=this.formatNumericDatum(s),o=t==="array"||t==="object"?this.formatDatum(n):void 0,l={content:r,title:o},a=this.processedOptions?.tooltip?.renderer;return a?I(a({context:this.context,datum:i,yValue:s,xValue:n}),l):I(l)}formatLabelValue(e){return e%1!==0?e.toFixed(1):e.toFixed(0)}},{isNumber:Kt}=$t,{BandScale:ot}=Gt,Zt=class extends rt{updateYScaleRange(){const{seriesRect:e,yScale:t}=this;t.range=[0,e.width]}updateXScaleRange(){const{xScale:e,seriesRect:t,paddingOuter:i,paddingInner:s}=this;if(e instanceof ot)e.range=[0,t.height],e.paddingInner=s,e.paddingOuter=i;else{const n=this.calculateStep(t.height),r=n*i;this.bandWidth=n*(1-s),e.range=[r,t.height-r-this.bandWidth]}}updateAxisLine(){const{yScale:e,axis:t,axisLine:i,seriesRect:s}=this,{strokeWidth:n}=t;i.x1=0,i.x2=0,i.y1=0,i.y2=s.height,i.stroke=t.stroke,i.strokeWidth=n+(n%2===1?1:0);const r=e.convert(0);i.translationX=r}generateNodeData(){const{data:e,yData:t,xData:i,xScale:s,yScale:n,fill:r,stroke:o,strokeWidth:l,label:a}=this;if(!e)return;const{fontStyle:h,fontWeight:y,fontSize:c,fontFamily:g,color:x,formatter:u,placement:f}=a,m=[],p=n.convert(0),S=!(s instanceof ot);for(let v=0,L=t.length;v<L;v++){let k=t[v];const w=i[v],F=k===void 0;F&&(k=0);const z=s.convert(S?s.toDomain(w):w),_=Math.min(k===void 0?NaN:n.convert(k),p),G=Math.max(k===void 0?NaN:n.convert(k),p),R=S?this.bandWidth:s.bandwidth,N=G-_,V={x:p,y:z};let M;u?M=u({value:k}):M=k!==void 0&&Kt(k)?this.formatLabelValue(k):"";const $=z+R/2;let b;const H="middle";let W;const D=k!==void 0&&k>=0,C=4;if(f==="center")b=_+N/2,W="center";else if(f==="outsideEnd")b=_+(D?N+C:-C),W=D?"start":"end";else if(f==="insideEnd"){b=_+(D?N-C:C),W=D?"end":"start";const B=Vt.Text.getTextSize(M,g).width||20,U=p+B,j=p-B;(D&&b<U||!D&&b>j)&&(b=p+C*(D?1:-1),W=D?"start":"end")}else b=p+C*(D?1:-1),W=D?"start":"end";m.push({x:_,y:z,width:N,height:R,fill:r,stroke:o,strokeWidth:l,seriesDatum:{x:w,y:F?void 0:k},point:V,label:{x:b,y:$,text:M,fontStyle:h,fontWeight:y,fontSize:c,fontFamily:g,textAlign:W,textBaseline:H,fill:x}})}return m}getDistance(e,t){return Math.abs(e.y-t.y)}};import{_Scale as Jt,_Scene as Qt,_Util as te}from"ag-charts-community";var{isNumber:ee}=te,{BandScale:lt}=Jt,ie=class extends rt{updateYScaleRange(){const{seriesRect:e,yScale:t}=this;t.range=[e.height,0]}updateXScaleRange(){const{xScale:e,seriesRect:t,paddingOuter:i,paddingInner:s}=this;if(e instanceof lt)e.range=[0,t.width],e.paddingInner=s,e.paddingOuter=i;else{const n=this.calculateStep(t.width),r=n*i;this.bandWidth=n*(1-s),e.range=[r,t.width-r-this.bandWidth]}}updateAxisLine(){const{yScale:e,axis:t,axisLine:i,seriesRect:s}=this,{strokeWidth:n}=t;i.x1=0,i.x2=s.width,i.y1=0,i.y2=0,i.stroke=t.stroke,i.strokeWidth=n+(n%2===1?1:0);const r=e.convert(0);i.translationY=r}generateNodeData(){const{data:e,yData:t,xData:i,xScale:s,yScale:n,fill:r,stroke:o,strokeWidth:l,label:a}=this;if(!e)return;const{fontStyle:h,fontWeight:y,fontSize:c,fontFamily:g,color:x,formatter:u,placement:f}=a,m=[],p=n.convert(0),S=!(s instanceof lt);for(let v=0,L=t.length;v<L;v++){let k=t[v];const w=i[v],F=k===void 0;F&&(k=0);const z=Math.min(k===void 0?NaN:n.convert(k),p),_=s.convert(S?s.toDomain(w):w),G=Math.max(k===void 0?NaN:n.convert(k),p),R=S?this.bandWidth:s.bandwidth,N=G-z,V={x:_+R/2,y:p};let M;u?M=u({value:k}):M=k!==void 0&&ee(k)?this.formatLabelValue(k):"";const $=_+R/2;let b;const H="center";let W;const D=k!==void 0&&k>=0,C=2;if(f==="center")b=z+N/2,W="middle";else if(f==="outsideEnd")b=z+(D?-C:N+C),W=D?"bottom":"top";else if(f==="insideEnd"){b=z+(D?C:N-C),W=D?"top":"bottom";const B=Qt.Text.getTextSize(M,g).height||10,U=p-B,j=p+B;(D&&b>U||!D&&b<j)&&(b=p+C*(D?-1:1),W=D?"bottom":"top")}else b=p+C*(D?-1:1),W=D?"bottom":"top";m.push({x:_,y:z,width:R,height:N,fill:r,stroke:o,strokeWidth:l,seriesDatum:{x:w,y:F?void 0:k},point:V,label:{x:$,y:b,text:M,fontStyle:h,fontWeight:y,fontSize:c,fontFamily:g,textAlign:H,textBaseline:W,fill:x}})}return m}};import{_Scale as se,_Scene as X,_Util as ne}from"ag-charts-community";var{extent:ae}=ne,{BandScale:ht}=se,re=class{constructor(){this.enabled=!0,this.shape="circle",this.size=0,this.fill="rgb(124, 181, 236)",this.stroke="rgb(124, 181, 236)",this.strokeWidth=1,this.formatter=void 0}},oe=class{constructor(){this.stroke="rgb(124, 181, 236)",this.strokeWidth=1}},le=class{constructor(){this.xLine={enabled:!0,stroke:"rgba(0,0,0, 0.54)",strokeWidth:1,lineDash:"solid",lineCap:void 0},this.yLine={enabled:!1,stroke:"rgba(0,0,0, 0.54)",strokeWidth:1,lineDash:"solid",lineCap:void 0}}},he=class extends K{constructor(){super(),this.linePath=new X.Path,this.xCrosshairLine=new X.Line,this.yCrosshairLine=new X.Line,this.lineSparklineGroup=new X.Group,this.markers=new X.Group,this.markerSelection=X.Selection.select(this.markers,()=>this.markerFactory()),this.markerSelectionData=[],this.marker=new re,this.line=new oe,this.crosshairs=new le,this.rootGroup.append(this.lineSparklineGroup),this.linePath.zIndex=1e3,this.xCrosshairLine.zIndex=2e3,this.yCrosshairLine.zIndex=2e3,this.markers.zIndex=2500,this.lineSparklineGroup.append([this.linePath,this.xCrosshairLine,this.yCrosshairLine,this.markers])}getNodeData(){return this.markerSelectionData}markerFactory(){const{shape:e}=this.marker,t=et(e);return new t}onMarkerShapeChange(){this.markerSelection=this.markerSelection.clear(),this.scheduleLayout()}update(){const e=this.generateNodeData();e&&(this.markerSelectionData=e,this.updateSelection(e),this.updateNodes(),this.updateLine())}updateYScaleDomain(){const{yData:e,yScale:t}=this,i=ae(e);let s=0,n=1;if(i!==void 0&&(s=this.min=i[0],n=this.max=i[1]),s===n){const r=Math.abs(s*.01);s-=r,n+=r}t.domain=[s,n]}generateNodeData(){const{data:e,yData:t,xData:i,xScale:s,yScale:n}=this;if(!e)return;const r=!(s instanceof ht),o=r?0:s.bandwidth/2,l=[];for(let a=0;a<t.length;a++){const h=t[a],y=i[a];if(h==null)continue;const c=s.convert(r?s.toDomain(y):y)+o,g=h===void 0?NaN:n.convert(h);l.push({seriesDatum:{x:y,y:h},point:{x:c,y:g}})}return l}updateSelection(e){this.markerSelection.update(e)}updateNodes(){const{highlightedDatum:e,highlightStyle:t,marker:i}=this,{size:s,fill:n,stroke:r,strokeWidth:o}=t,l=i.formatter;this.markerSelection.each((a,h,y)=>{const c=h===e,g=c&&n!==void 0?n:i.fill,x=c&&r!==void 0?r:i.stroke,u=c&&o!==void 0?o:i.strokeWidth,f=c&&s!==void 0?s:i.size;let m;const{seriesDatum:p,point:S}=h;if(l){const v=y===0,L=y===this.markerSelectionData.length-1,k=p.y===this.min,w=p.y===this.max;m=l({datum:h,xValue:p.x,yValue:p.y,min:k,max:w,first:v,last:L,fill:g,stroke:x,strokeWidth:u,size:f,highlighted:c})}a.size=m&&m.size!=null?m.size:f,a.fill=m&&m.fill!=null?m.fill:g,a.stroke=m&&m.stroke!=null?m.stroke:x,a.strokeWidth=m&&m.strokeWidth!=null?m.strokeWidth:u,a.translationX=S.x,a.translationY=S.y,a.visible=m&&m.enabled!=null?m.enabled:i.enabled&&a.size>0})}updateLine(){const{linePath:e,yData:t,xData:i,xScale:s,yScale:n,line:r}=this,o=e.path;if(o.clear(),t.length<2)return;const l=!(s instanceof ht),a=t.length,h=l?0:s.bandwidth/2;let y=!0;for(let c=0;c<a;c++){const g=i[c],x=t[c],u=s.convert(l?s.toDomain(g):g)+h,f=x===void 0?NaN:n.convert(x);x==null?y=!0:y?(o.moveTo(u,f),y=!1):o.lineTo(u,f)}e.fill=void 0,e.stroke=r.stroke,e.strokeWidth=r.strokeWidth}updateXCrosshairLine(){const{yScale:e,xCrosshairLine:t,highlightedDatum:i,crosshairs:{xLine:s}}=this;if(!s.enabled||i==null){t.strokeWidth=0;return}t.y1=e.range[0],t.y2=e.range[1],t.x1=t.x2=0,t.stroke=s.stroke,t.strokeWidth=s.strokeWidth??1,t.lineCap=s.lineCap==="round"||s.lineCap==="square"?s.lineCap:void 0;const{lineDash:n}=s;t.lineDash=Array.isArray(n)?n:E(t.lineCap,s.lineDash),t.translationX=i.point.x}updateYCrosshairLine(){const{xScale:e,yCrosshairLine:t,highlightedDatum:i,crosshairs:{yLine:s}}=this;if(!s.enabled||i==null){t.strokeWidth=0;return}t.x1=e.range[0],t.x2=e.range[1],t.y1=t.y2=0,t.stroke=s.stroke,t.strokeWidth=s.strokeWidth??1,t.lineCap=s.lineCap==="round"||s.lineCap==="square"?s.lineCap:void 0;const{lineDash:n}=s;t.lineDash=Array.isArray(n)?n:E(t.lineCap,s.lineDash),t.translationY=i.point.y}getTooltipHtml(e){const{dataType:t}=this,{seriesDatum:i}=e,s=i.y,n=i.x,r=this.formatNumericDatum(s),o=t==="array"||t==="object"?this.formatDatum(n):void 0,l={content:r,title:o},a=this.processedOptions?.tooltip?.renderer;return a?I(a({context:this.context,datum:i,yValue:s,xValue:n}),l):I(l)}},{isNumber:ce}=Q,de=class{static create(e,t){e=Q.deepClone(e);const i=ue(e.type);return t&&(i.tooltip=t),fe(i,e),me(i,e),e.data&&(i.data=e.data),i.processedOptions=e,i}};function ue(e="line"){switch(e){case"column":return new ie;case"bar":return new Zt;case"area":return new Yt;case"line":default:return new he}}function me(e,t){switch(t.type){case"bar":ct(e,t);break;case"column":ct(e,t);break;case"area":ge(e,t);break;case"line":default:pe(e,t);break}}function fe(e,t){d(e,"context",t.context,t),d(e,"width",t.width,t),d(e,"height",t.height,t),d(e,"container",t.container,t),d(e,"xKey",t.xKey,t),d(e,"yKey",t.yKey,t),t.padding&&ye(e.padding,t.padding),t.axis&&Se(e.axis,t.axis),t.highlightStyle&&ke(e.highlightStyle,t.highlightStyle)}function pe(e,t){t.marker&&dt(e.marker,t.marker),t.line&&ut(e.line,t.line),t.crosshairs&&mt(e.crosshairs,t.crosshairs)}function ge(e,t){d(e,"fill",t.fill,t),t.marker&&dt(e.marker,t.marker),t.line&&ut(e.line,t.line),t.crosshairs&&mt(e.crosshairs,t.crosshairs)}function ct(e,t){d(e,"valueAxisDomain",t.valueAxisDomain,t),d(e,"fill",t.fill,t),d(e,"stroke",t.stroke,t),d(e,"strokeWidth",t.strokeWidth,t),d(e,"paddingInner",t.paddingInner,t),d(e,"paddingOuter",t.paddingOuter,t),d(e,"formatter",t.formatter,t),t.label&&xe(e.label,t.label)}function ye(e,t){d(e,"top",t.top,t),d(e,"right",t.right,t),d(e,"bottom",t.bottom,t),d(e,"left",t.left,t)}function dt(e,t){d(e,"enabled",t.enabled,t),d(e,"size",t.size,t),d(e,"shape",t.shape,t),d(e,"fill",t.fill,t),d(e,"stroke",t.stroke,t),d(e,"strokeWidth",t.strokeWidth,t),d(e,"formatter",t.formatter,t)}function xe(e,t){d(e,"enabled",t.enabled,t),d(e,"fontStyle",t.fontStyle,t),d(e,"fontWeight",t.fontWeight,t),d(e,"fontSize",t.fontSize,t),d(e,"fontFamily",t.fontFamily,t),d(e,"textAlign",t.textAlign,t),d(e,"textBaseline",t.textBaseline,t),d(e,"color",t.color,t),d(e,"formatter",t.formatter,t),d(e,"placement",t.placement,t)}function ut(e,t){d(e,"stroke",t.stroke,t),d(e,"strokeWidth",t.strokeWidth,t)}function Se(e,t){d(e,"type",t.type,t),d(e,"stroke",t.stroke,t),d(e,"strokeWidth",t.strokeWidth,t)}function ke(e,t){d(e,"fill",t.fill,t),d(e,"size",t.size,t),d(e,"stroke",t.stroke,t),d(e,"strokeWidth",t.strokeWidth,t)}function mt(e,t){e.xLine&&t.xLine&&ft(e.xLine,t.xLine),e.yLine&&t.yLine&&ft(e.yLine,t.yLine)}function ft(e,t){d(e,"enabled",t.enabled,t),d(e,"stroke",t.stroke,t),d(e,"strokeWidth",t.strokeWidth,t),d(e,"lineDash",t.lineDash,t),d(e,"lineCap",t.lineCap,t)}var pt=(e,t,i)=>ce(t)?!0:(J(`${e} must be a number, the value you provided is not a valid number. Using the default of ${i}px.`),!1),ve={xOffset:pt,yOffset:pt};function d(e,t,i,s){if(t in s)if(t in e){const n=ve[t];(n?n(t,i,e[t]):!0)&&e[t]!==i&&(e[t]=i)}else J(`Property ${t} does not exist on the target object.`)}var De=class extends kt{constructor(){super(`<div class="ag-sparkline-wrapper">
            <span data-ref="eSparkline"></span>
        </div>`),this.eSparkline=vt}wireBeans(e){this.resizeObserverService=e.resizeObserverService,this.sparklineTooltipSingleton=e.sparklineTooltipSingleton}init(e){let t=!0;const i=()=>{const{clientWidth:n,clientHeight:r}=this.getGui();if(!(n===0||r===0))if(t){const o={data:e.value,width:n,height:r,context:{data:e.data},...e.sparklineOptions};this.sparkline=de.create(o,this.sparklineTooltipSingleton.getSparklineTooltip()),this.eSparkline.appendChild(this.sparkline.canvasElement),t=!1}else this.sparkline.width=n,this.sparkline.height=r},s=this.resizeObserverService.observeResize(this.getGui(),i);this.addDestroyFunc(()=>s())}refresh(e){return this.sparkline?(this.sparkline.data=e.value,!0):!1}destroy(){this.sparkline&&this.sparkline.destroy(),super.destroy()}};import{BeanStub as be}from"@ag-grid-community/core";var Le=class extends be{constructor(){super(...arguments),this.beanName="sparklineTooltipSingleton"}postConstruct(){this.tooltip=new Rt}getSparklineTooltip(){return this.tooltip}destroy(){this.tooltip&&this.tooltip.destroy(),super.destroy()}},we="32.0.0",We={version:we,moduleName:xt.SparklinesModule,beans:[Le],userComponents:[{name:"agSparklineCellRenderer",classImp:De}],dependantModules:[St]};export{We as SparklinesModule};
